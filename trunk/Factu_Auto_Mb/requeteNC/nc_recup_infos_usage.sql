select decode(cd.TYPE_ID_USG, 11000, '3P - Appel direct durée',
11001, '1P - Appel direct durée',
11020, 'Appels vers Publiphones (Direct)',
11021, '1P - Appels vers Publiphones (Direct)',
11200, '3P - Appel direct durée - Porté chez FT',
11201, '1P - Appel direct durée - Porté chez FT',
11221, '1P - Appels vers Publiphones (Direct) - Porté chez FT',
11300, '3P - Appel direct durée - Porté chez CPTL',
11301, '1P - Appel direct durée - Porté chez CPTL',
11321, '1P - Appels vers Publiphones (Direct) - Porté chez CPTL',
11400, '3P - Appel direct durée - Porté chez autre',
11401, '1P - Appel direct durée - Porté chez autre',
11421, '1P - Appels vers Publiphones (Direct)- Porté chez autre',
11500, '3P - Appel direct durée - Autre 1',
11501, '1P - Appel direct durée - Autre 1',
11521, '1P - Appels vers Publiphones (Direct)- Autre 1',
11600, '3P - Appel direct durée - Autre 2',
11601, '1P - Appel direct durée - Autre 2',
11621, '1P - Appels vers Publiphones (Direct) - Autre 2',
11705, '3P - Appel Direct vers Porté Orange',
11715, '3P - Appel Direct vers Porté SFR',
11725, '3P - Appel Direct vers Porté Bouygues',
11706, '1P - Appel Direct vers Porté Orange',
11716, '1P - Appel Direct vers Porté SFR',
11726, '1P - Appel Direct vers Porté Bouygues',
11735, '3P - Appel Direct vers Porté Guyane Mobile',
11745, '3P - Appel Direct vers Porté Martinique Mobile',
11755, '3P - Appel Direct vers Porté Réunion Mobile',
11736, '1P - Appel Direct vers Porté Guyane Mobile',
11746, '1P - Appel Direct vers Porté Martinique Mobile',
11756, '1P - Appel Direct vers Porté Réunion Mobile',
12000, '3P - Appel num. spéciaux impulsion',
12001, '1P - Appel num. spéciaux impulsion',
12200, '3P - Appel num. spéciaux impulsion - Porté chez FT',
12201, '1P - Appel num. spéciaux impulsion - Porté chez FT',
12300, '3P - Appel num. spéciaux impulsion - Porté chez CPTL',
12301, '1P - Appel num. spéciaux impulsion - Porté chez CPTL',
12400, '3P - Appel num. spéciaux impulsion - Porté chez autre',
12401, '1P - Appel num. spéciaux impulsion - Porté chez autre',
12500, '3P - Appel num. spéciaux impulsion - Autre 1',
12501, '1P - Appel num. spéciaux impulsion - Autre 1',
12600, '3P - Appel num. spéciaux impulsion - Autre 2',
12601, '1P - Appel num. spéciaux impulsion - Autre 2',
13000, '3P - Appel indirect durée',
13020, 'Appels vers Publiphones (Indirect)',
13200, '3P - Appel indirect durée - Porté chez FT',
13300, '3P - Appel indirect durée - Porté chez CPTL',
13400, '3P - Appel indirect durée - Porté chez autre',
13500, '3P - Appel indirect durée - Autre 1',
13600, '3P - Appel indirect durée - Autre 2',
13705, '3P - Appel Indirect vers Porté Orange',
13715, '3P - Appel Indirect vers Porté SFR',
13725, '3P - Appel Indirect vers Porté Bouygues',
13735, '3P - Appel Indirect vers Porté Guyane Mobile',
13745, '3P - Appel Indirect vers Porté Martinique Mobile',
13755, '3P - Appel Indirect vers Porté Réunion Mobile',
14000, 'Appel indirect impulsion',
14200, 'Appel indirect impulsion - Porté chez FT',
14300, 'Appel indirect impulsion - Porté chez CPTL',
14400, 'Appel indirect impulsion - Porté chez autre',
14500, 'Appel indirect impulsion - Autre 1',
14600, 'Appel indirect impulsion - Autre 2',
18000, '3P - Renvoi d''appel',
18001, '1P - Renvoi d''appel',
18200, '3P - Renvoi d''appel - Porté chez FT',
18201, '1P - Renvoi d''appel - Porté chez FT',
18300, '3P - Renvoi d''appel - Porté chez CPTL',
18301, '1P - Renvoi d''appel - Porté chez CPTL',
18400, '3P - Renvoi d''appel - Porté chez autre',
18401, '1P - Renvoi d''appel - Porté chez autre',
18500, '3P - Renvoi d''appel - Autre 1',
18501, '1P - Renvoi d''appel - Autre 1',
18600, '3P - Renvoi d''appel - Autre 2',
18601, '1P - Renvoi d''appel - Autre 2',
18705, '3P - Renvoi d''appel vers Porté Orange',
18706, '1P - Renvoi d''appel vers Porté Orange',
18715, '3P - Renvoi d''appel vers Porté SFR',
18716, '1P - Renvoi d''appel vers Porté SFR',
18725, '3P - Renvoi d''appel vers Porté Bouygues',
18726, '1P - Renvoi d''appel vers Porté Bouygues',
18735, '3P - Renvoi d''appel vers Porté Guyane Mobile',
18736, '1P - Renvoi d''appel vers Porté Guyane Mobile',
18745, '3P - Renvoi d''appel vers Porté Martinique Mobile',
18746, '1P - Renvoi d''appel vers Porté Martinique Mobile',
18755, '3P - Renvoi d''appel vers Porté Réunion Mobile',
18756, '1P - Renvoi d''appel vers Porté Réunion Mobile') as Type_Trafic,
	   jcv.DISPLAY_VALUE as Classe_Juridiction,
	   j.JURISDICTION as Code_Juridiction,
	   d.DESCRIPTION_TEXT as Libellé_Juridiction,
	   (bid.AMOUNT + bid.RATED_AMOUNT)/100 as Euro_HT,
	   (bid.SECONDARY_AMOUNT)/100 as Remise,
	   (bid.AMOUNT + bid.DISCOUNT)/100 as HT_Remisé,
	   bid.COMPONENT_ID as Nbre_appels,
	   sum(cd.PRIMARY_UNITS - cb.UNITS_CREDITED) as Durée_Facturée
from CDR_DATA cd, CDR_BILLED cb, JURISDICTIONS j, DESCRIPTIONS d, JURISDICTION_CLASS_VALUES jcv, BILL_INVOICE_DETAIL bid
where /*cd.TYPE_ID_USG in (11000, 11020, 11200, 11300, 11400, 12000, 18000, 18200, 18300, 18400)
and */cd.MSG_ID = cb.MSG_ID
and cd.MSG_ID2 = cb.MSG_ID2
and cd.MSG_ID_SERV = cb.MSG_ID_SERV
and cd.CDR_DATA_PARTITION_KEY = cb.CDR_DATA_PARTITION_KEY
and cd.SPLIT_ROW_NUM = cb.SPLIT_ROW_NUM
and cb.BILL_REF_NO = numFact  /* numFac= numero de la facture qui servivra de mapping dans l'application*/
and cd.JURISDICTION = j.JURISDICTION
and jcv.JURISDICTION_CLASS = j.JURISDICTION_CLASS
and jcv.LANGUAGE_CODE = 2
and j.DESCRIPTION_CODE = d.DESCRIPTION_CODE
and d.LANGUAGE_CODE = 2
and cd.JURISDICTION = bid.RATE_TYPE
and cd.TYPE_ID_USG = bid.SUBTYPE_CODE
and cb.BILL_REF_NO = bid.BILL_REF_NO
and cb.BILL_REF_RESETS = bid.BILL_REF_RESETS
and cb.BILL_INVOICE_ROW = bid.BILL_INVOICE_ROW
group by decode(cd.TYPE_ID_USG, 11000, '3P - Appel direct durée',
11001, '1P - Appel direct durée',
11020, 'Appels vers Publiphones (Direct)',
11021, '1P - Appels vers Publiphones (Direct)',
11200, '3P - Appel direct durée - Porté chez FT',
11201, '1P - Appel direct durée - Porté chez FT',
11221, '1P - Appels vers Publiphones (Direct) - Porté chez FT',
11300, '3P - Appel direct durée - Porté chez CPTL',
11301, '1P - Appel direct durée - Porté chez CPTL',
11321, '1P - Appels vers Publiphones (Direct) - Porté chez CPTL',
11400, '3P - Appel direct durée - Porté chez autre',
11401, '1P - Appel direct durée - Porté chez autre',
11421, '1P - Appels vers Publiphones (Direct)- Porté chez autre',
11500, '3P - Appel direct durée - Autre 1',
11501, '1P - Appel direct durée - Autre 1',
11521, '1P - Appels vers Publiphones (Direct)- Autre 1',
11600, '3P - Appel direct durée - Autre 2',
11601, '1P - Appel direct durée - Autre 2',
11621, '1P - Appels vers Publiphones (Direct) - Autre 2',
11705, '3P - Appel Direct vers Porté Orange',
11715, '3P - Appel Direct vers Porté SFR',
11725, '3P - Appel Direct vers Porté Bouygues',
11706, '1P - Appel Direct vers Porté Orange',
11716, '1P - Appel Direct vers Porté SFR',
11726, '1P - Appel Direct vers Porté Bouygues',
11735, '3P - Appel Direct vers Porté Guyane Mobile',
11745, '3P - Appel Direct vers Porté Martinique Mobile',
11755, '3P - Appel Direct vers Porté Réunion Mobile',
11736, '1P - Appel Direct vers Porté Guyane Mobile',
11746, '1P - Appel Direct vers Porté Martinique Mobile',
11756, '1P - Appel Direct vers Porté Réunion Mobile',
12000, '3P - Appel num. spéciaux impulsion',
12001, '1P - Appel num. spéciaux impulsion',
12200, '3P - Appel num. spéciaux impulsion - Porté chez FT',
12201, '1P - Appel num. spéciaux impulsion - Porté chez FT',
12300, '3P - Appel num. spéciaux impulsion - Porté chez CPTL',
12301, '1P - Appel num. spéciaux impulsion - Porté chez CPTL',
12400, '3P - Appel num. spéciaux impulsion - Porté chez autre',
12401, '1P - Appel num. spéciaux impulsion - Porté chez autre',
12500, '3P - Appel num. spéciaux impulsion - Autre 1',
12501, '1P - Appel num. spéciaux impulsion - Autre 1',
12600, '3P - Appel num. spéciaux impulsion - Autre 2',
12601, '1P - Appel num. spéciaux impulsion - Autre 2',
13000, '3P - Appel indirect durée',
13020, 'Appels vers Publiphones (Indirect)',
13200, '3P - Appel indirect durée - Porté chez FT',
13300, '3P - Appel indirect durée - Porté chez CPTL',
13400, '3P - Appel indirect durée - Porté chez autre',
13500, '3P - Appel indirect durée - Autre 1',
13600, '3P - Appel indirect durée - Autre 2',
13705, '3P - Appel Indirect vers Porté Orange',
13715, '3P - Appel Indirect vers Porté SFR',
13725, '3P - Appel Indirect vers Porté Bouygues',
13735, '3P - Appel Indirect vers Porté Guyane Mobile',
13745, '3P - Appel Indirect vers Porté Martinique Mobile',
13755, '3P - Appel Indirect vers Porté Réunion Mobile',
14000, 'Appel indirect impulsion',
14200, 'Appel indirect impulsion - Porté chez FT',
14300, 'Appel indirect impulsion - Porté chez CPTL',
14400, 'Appel indirect impulsion - Porté chez autre',
14500, 'Appel indirect impulsion - Autre 1',
14600, 'Appel indirect impulsion - Autre 2',
18000, '3P - Renvoi d''appel',
18001, '1P - Renvoi d''appel',
18200, '3P - Renvoi d''appel - Porté chez FT',
18201, '1P - Renvoi d''appel - Porté chez FT',
18300, '3P - Renvoi d''appel - Porté chez CPTL',
18301, '1P - Renvoi d''appel - Porté chez CPTL',
18400, '3P - Renvoi d''appel - Porté chez autre',
18401, '1P - Renvoi d''appel - Porté chez autre',
18500, '3P - Renvoi d''appel - Autre 1',
18501, '1P - Renvoi d''appel - Autre 1',
18600, '3P - Renvoi d''appel - Autre 2',
18601, '1P - Renvoi d''appel - Autre 2',
18705, '3P - Renvoi d''appel vers Porté Orange',
18706, '1P - Renvoi d''appel vers Porté Orange',
18715, '3P - Renvoi d''appel vers Porté SFR',
18716, '1P - Renvoi d''appel vers Porté SFR',
18725, '3P - Renvoi d''appel vers Porté Bouygues',
18726, '1P - Renvoi d''appel vers Porté Bouygues',
18735, '3P - Renvoi d''appel vers Porté Guyane Mobile',
18736, '1P - Renvoi d''appel vers Porté Guyane Mobile',
18745, '3P - Renvoi d''appel vers Porté Martinique Mobile',
18746, '1P - Renvoi d''appel vers Porté Martinique Mobile',
18755, '3P - Renvoi d''appel vers Porté Réunion Mobile',
18756, '1P - Renvoi d''appel vers Porté Réunion Mobile'),
	   jcv.DISPLAY_VALUE,
	   j.JURISDICTION,
	   d.DESCRIPTION_TEXT,
	   bid.AMOUNT + bid.RATED_AMOUNT,
	   bid.SECONDARY_AMOUNT,
	   bid.AMOUNT + bid.DISCOUNT,
	   bid.COMPONENT_ID,
	   cb.BILL_INVOICE_ROW -- AJOUTE LE 05/03/2009
order by 2, 3, 1